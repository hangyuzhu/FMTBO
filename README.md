# Federated Many-Task Bayesian Optimization
 
This is the code implementation of our paper "Federated Many-Task Bayesian Optimization". You can find the paper through the early access [TEVC](https://ieeexplore.ieee.org/document/10141991])

## Quick Start
You can easily run the code by .sh files in the folder of experiments.

sh mtp.sh: FHS, FHS-FEI

sh mtpkt.sh: FHS-KT, FMTBO

## Non-IID simulations
Remove the argument --iid and set --np_per_dim for number of partitions per feature dimension

## SOP
Contain bencmark single objective problems: **Griewank, Rastrigin, Ackley, Schwefel, Sphere, Rosenbrock, Weierstrass, Ellipsoid**

## Multi/Many Task problems
The sythetic many-task problems include 18 tasks generated by transformation matrices.

```python
class MultiTaskTransform(Transform):

    def __init__(self, rot_mat=1, shift_mat=0):
        self.rot_mat = rot_mat
        self.shift_mat = shift_mat

    def __call__(self, x: np.ndarray):
        assert len(x.shape) == 1
        return self._rotate(self._shift(x))

    def _shift(self, x):
        return x - self.shift_mat

    def _rotate(self, x):
        return np.dot(self.rot_mat, x)
```

## Reference
**H. Zhu, X. Wang and Y. Jin, "Federated Many-Task Bayesian Optimization," in IEEE Transactions on Evolutionary Computation, doi: 10.1109/TEVC.2023.3279775.**
